"use strict";!function(t,e){var n=ax5.util,r=new Date,a=function(t,e){if("undefined"==typeof e&&(e=t.value.length),t.setSelectionRange)t.focus(),t.setSelectionRange(e,e);else if(t.createTextRange){var n=t.createTextRange();n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",e),n.select()}else t.selectionStart&&(t.focus(),t.selectionStart=e,t.selectionEnd=e)},u=function(){var t;e&&e.call(this),this.queue=[],this.config={animateTime:250},this.openTimer=null,this.closeTimer=null,t=this.config,this.init=function(){},this.bind=function(e){var r={};return jQuery.extend(!0,r,t),e&&jQuery.extend(!0,r,e),e=r,e.target?(e.$target=jQuery(e.target),e.id||(e.id="ax5-formatter-"+ax5.getGuid()),-1===n.search(this.queue,function(){return this.id==e.id})&&(this.queue.push(e),this.__bindFormatterTarget(this.queue[this.queue.length-1],this.queue.length-1)),this):(console.log(ax5.info.getError("ax5formatter","401","bind")),this)},this.__bindFormatterTarget=function(){var t={18:"KEY_ALT",8:"KEY_BACKSPACE",17:"KEY_CONTROL",46:"KEY_DELETE",40:"KEY_DOWN",35:"KEY_END",187:"KEY_EQUAL",27:"KEY_ESC",36:"KEY_HOME",45:"KEY_INSERT",37:"KEY_LEFT",189:"KEY_MINUS",34:"KEY_PAGEDOWN",33:"KEY_PAGEUP",13:"KEY_RETURN",39:"KEY_RIGHT",16:"KEY_SHIFT",9:"KEY_TAB",38:"KEY_UP",91:"KEY_WINDOW"},e={48:1,49:1,50:1,51:1,52:1,53:1,54:1,55:1,56:1,57:1,96:1,97:1,98:1,99:1,100:1,101:1,102:1,103:1,104:1,105:1},u={money:function(n,r){var a={188:","};"int"==n.patternArgument||(a[190]="."),a=$.extend(a,t),n.enterableKeyCodes=$.extend(a,e)},number:function(n,r){var a={190:"."};a=$.extend(a,t),n.enterableKeyCodes=$.extend(a,e)},date:function(n,r){var a={189:"-",191:"/"};a=$.extend(a,t),n.enterableKeyCodes=$.extend(a,e)},time:function(n,r){var a={186:":"};a=$.extend(a,t),n.enterableKeyCodes=$.extend(a,e)},bizno:function(n,r){var a={189:"-"};a=$.extend(a,t),n.enterableKeyCodes=$.extend(a,e)},phone:function(n,r){var a={189:"-",188:","};a=$.extend(a,t),n.enterableKeyCodes=$.extend(a,e)},custom:function(n,r){var a={};a=$.extend(a,t),n.enterableKeyCodes=$.extend(a,e)}},i={money:function(t,e,r,a,u){var i,a=a.replace(/[^0-9^\.^\-]/g,""),o=new RegExp("([0-9])([0-9][0-9][0-9][,.])"),s=a.split(".");s[0]+=".";do s[0]=s[0].replace(o,"$1,$2");while(o.test(s[0]));return i=s.length>1?n.isNumber(t.maxRound)?s[0]+n.left(s[1],t.maxRound):s.join(""):s[0].split(".")[0]},number:function(t,e,r,a,u){a=a.replace(/[^0-9^\.^\-]/g,"");var i,o=a.split(".");return i=o.length>1?n.isNumber(t.maxRound)?o[0]+n.left(o[1],t.maxRound):o.join(""):o[0].split(".")[0]},date:function(t,e,a,u,i){u=u.replace(/\D/g,"");var o=/^([0-9]{4})\-?([0-9]{1,2})?\-?([0-9]{1,2})?.*$/;"time"==t.patternArgument&&(o=/^([0-9]{4})\-?([0-9]{1,2})?\-?([0-9]{1,2})? ?([0-9]{1,2})?:?([0-9]{1,2})?:?([0-9]{1,2})?.*$/);var s=u.match(o),g="",c=function(t,e,a,u){var i={Y:function(t){return"undefined"==typeof t&&(t=r.getFullYear()),"0000"==t&&(t=r.getFullYear()),t.length<4?n.setDigit(t,4):t},M:function(t){return"undefined"==typeof t&&(t=r.getMonth()+1),t>12?12:0==t?"01":n.setDigit(t,2)},D:function(t){"undefined"==typeof t&&(t=r.getDate()+1);var e=n.daysOfMonth(u[1],u[2]-1);return t>e?e:0==t?"01":n.setDigit(t,2)},h:function(t){return t||(t=0),t>23?23:n.setDigit(t,2)},m:function(t){return t||(t=0),t>59?59:n.setDigit(t,2)},s:function(t){return t||(t=0),t>59?59:n.setDigit(t,2)}};return a?i[e](t):t};return g=u.replace(o,function(e,n){var r=[c(arguments[1],"Y",i)];return(arguments[2]||i)&&r.push("-"+c(arguments[2],"M",i)),(arguments[3]||i)&&r.push("-"+c(arguments[3],"D",i,arguments)),"time"==t.patternArgument&&((arguments[4]||i)&&r.push(" "+c(arguments[4],"h",i)),(arguments[5]||i)&&r.push(":"+c(arguments[5],"m",i)),(arguments[6]||i)&&r.push(":"+c(arguments[6],"s",i))),r.join("")}),"blur"!=i||s?s||(g=g.length>4?n.left(g,4):g):g=function(){var e=[c(g,"Y",i)];return e.push("-"+c(0,"M",i)),e.push("-"+c(0,"D",i,arguments)),"time"==t.patternArgument&&(e.push(" "+c(0,"h",i)),e.push(":"+c(0,"m",i)),e.push(":"+c(0,"s",i))),e.join("")}(),g},time:function(t,e,r,a,u){a=a.replace(/\D/g,"");var i=/^([0-9]{1,2})?:?([0-9]{1,2})?:?([0-9]{1,2})?.*$/,o=a.match(i),s=a.replace(i,function(t,e){var n=[arguments[1]];return arguments[2]&&n.push(":"+arguments[2]),arguments[3]&&n.push(":"+arguments[3]),n.join("")});return o||(s=s.length>2?n.left(s,2):s),s},bizno:function(t,e,n,r,a){r=r.replace(/\D/g,"");var u=/^([0-9]{3})\-?([0-9]{1,2})?\-?([0-9]{1,5})?.*$/,i=r.replace(u,function(t,e){var n=[arguments[1]];return arguments[2]&&n.push(arguments[2]),arguments[3]&&n.push(arguments[3]),n.join("-")});return i},phone:function(t,e,n,r,a){r=r.replace(/\D/g,"");var u=/^([0-9]{3})\-?([0-9]{1,4})?\-?([0-9]{1,4})?\-?([0-9]{1,4})?\-?([0-9]{1,4})?/,i=r.replace(u,function(t,e){var n=[arguments[1]];return arguments[2]&&n.push(arguments[2]),arguments[3]&&n.push(arguments[3]),arguments[4]&&n.push(arguments[4]),arguments[5]&&n.push(arguments[5]),n.join("-")});return i},custom:function(t,e,n,r,a){return t.getPatternValue?t.getPatternValue.call(t,{event:n,$input:t.$input,value:r}):void 0}},o={focus:function(t,e,n){t.$input.data("__originValue__")||t.$input.data("__originValue__",t.$input.val())},keydown:function(t,e,n){var r=!1;n.which&&t.enterableKeyCodes[n.which]||n.metaKey||n.ctrlKey||n.shiftKey||(r=!0),r&&ax5.util.stopEvent(n)},keyup:function(t,e,n){var r,u,o,s,g,c=t.$input.get(0);"selectionStart"in c?r=c.selectionStart:document.selection&&(s=document.selection.createRange(),g=document.selection.createRange().text.length,s.moveStart("character",-c.value.length),r=s.text.length-g),u=c.value,o=i[t.pattern]?i[t.pattern].call(this,t,e,n,c.value):u,o!=u&&(t.$input.val(o).trigger("change"),a(c,r+o.length-u.length))},blur:function(t,e,n){var r,a,u=t.$input.get(0);t.$input.removeData("__originValue__"),r=u.value,a=i[t.pattern]?i[t.pattern].call(this,t,e,n,u.value,"blur"):r,a!=r&&t.$input.val(a).trigger("change")}};return function(t,e){if(!t.pattern&&("INPUT"==t.$target.get(0).tagName?t.pattern=t.$target.attr("data-ax5formatter"):t.pattern=t.$target.find('input[type="text"]').attr("data-ax5formatter"),!t.pattern))return console.log(ax5.info.getError("ax5formatter","501","bind")),console.log(t.target),this;var n=/[^\(^\))]+/gi,r=t.pattern.match(n);t.pattern=r[0],t.patternArgument=r[1]||"";for(var a in u)if(t.pattern==a){u[a].call(this,t,e);break}return t.$input="INPUT"==t.$target.get(0).tagName?t.$target:t.$target.find('input[type="text"]'),t.$input.unbind("focus.ax5formatter").bind("focus.ax5formatter",o.focus.bind(this,this.queue[e],e)),t.$input.unbind("keydown.ax5formatter").bind("keydown.ax5formatter",o.keydown.bind(this,this.queue[e],e)),t.$input.unbind("keyup.ax5formatter").bind("keyup.ax5formatter",o.keyup.bind(this,this.queue[e],e)),t.$input.unbind("blur.ax5formatter").bind("blur.ax5formatter",o.blur.bind(this,this.queue[e],e)),this}}(),this.main=function(){arguments&&n.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)};t.formatter=function(){return n.isFunction(e)&&(u.prototype=new e),u}()}(ax5.ui,ax5.ui.root),ax5.ui.formatter_instance=new ax5.ui.formatter,$.fn.ax5formatter=function(){return function(t){return"undefined"==typeof t&&(t={}),$.each(this,function(){var e={target:this};t=$.extend(!0,t,e),ax5.ui.formatter_instance.bind(t)}),this}}();